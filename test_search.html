<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Search Functionality Test - SDOIN</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    .test-section {
      padding: 2rem;
      margin: 1rem 0;
      border: 1px solid #dee2e6;
      border-radius: 8px;
    }
    .test-result {
      padding: 0.5rem;
      margin: 0.5rem 0;
      border-radius: 4px;
    }
    .test-success { background-color: #d4edda; color: #155724; }
    .test-error { background-color: #f8d7da; color: #721c24; }
    .test-warning { background-color: #fff3cd; color: #856404; }
  </style>
</head>
<body>
  <div class="container mt-4">
    <h1><i class="fas fa-search me-2"></i>Search Functionality Test</h1>
    <p class="lead">This page tests the search functionality across the SDOIN website.</p>

    <div class="test-section">
      <h3>1. Database Connection Test</h3>
      <div id="dbTest" class="test-result">Testing database connection...</div>
    </div>

    <div class="test-section">
      <h3>2. Search API Test</h3>
      <div id="apiTest" class="test-result">Testing search API...</div>
    </div>

    <div class="test-section">
      <h3>3. Search Bar Component Test</h3>
      <div id="componentTest" class="test-result">Testing search bar component...</div>
      <div id="searchBarTestContainer" class="mt-3"></div>
    </div>

    <div class="test-section">
      <h3>4. Page Navigation Test</h3>
      <div id="navigationTest" class="test-result">Testing page navigation...</div>
      <div class="mt-3">
        <a href="index.html" class="btn btn-primary me-2">Home</a>
        <a href="search.html" class="btn btn-success me-2">Search Page</a>
        <a href="about.html" class="btn btn-info me-2">About</a>
        <a href="programs.html" class="btn btn-warning me-2">Programs</a>
        <a href="news.html" class="btn btn-secondary">News</a>
      </div>
    </div>

    <div class="test-section">
      <h3>5. Test Results Summary</h3>
      <div id="summary" class="test-result">Running tests...</div>
    </div>
  </div>

  <script src="search_bar.js"></script>
  <script>
    let testResults = {
      database: false,
      api: false,
      component: false,
      navigation: false
    };

    // Test 1: Database Connection
    async function testDatabase() {
      try {
        const response = await fetch('backend/search_api.php?q=test');
        if (response.ok) {
          const data = await response.json();
          document.getElementById('dbTest').innerHTML = 
            '<span class="test-success">âœ“ Database connection successful</span>';
          testResults.database = true;
        } else {
          throw new Error('API returned error status');
        }
      } catch (error) {
        document.getElementById('dbTest').innerHTML = 
          '<span class="test-error">âœ— Database connection failed: ' + error.message + '</span>';
      }
    }

    // Test 2: Search API
    async function testSearchAPI() {
      try {
        const response = await fetch('backend/search_api.php?q=education');
        if (response.ok) {
          const data = await response.json();
          if (data.results && Array.isArray(data.results)) {
            document.getElementById('apiTest').innerHTML = 
              '<span class="test-success">âœ“ Search API working - Found ' + data.total + ' results</span>';
            testResults.api = true;
          } else {
            throw new Error('Invalid response format');
          }
        } else {
          throw new Error('API returned error status');
        }
      } catch (error) {
        document.getElementById('apiTest').innerHTML = 
          '<span class="test-error">âœ— Search API failed: ' + error.message + '</span>';
      }
    }

    // Test 3: Search Bar Component
    function testSearchComponent() {
      try {
        const container = document.getElementById('searchBarTestContainer');
        if (container) {
          new SDOINSearchBar(container, {
            placeholder: 'Test Search...',
            showSuggestions: true,
            autoComplete: true
          });
          document.getElementById('componentTest').innerHTML = 
            '<span class="test-success">âœ“ Search bar component loaded successfully</span>';
          testResults.component = true;
        } else {
          throw new Error('Container not found');
        }
      } catch (error) {
        document.getElementById('componentTest').innerHTML = 
          '<span class="test-error">âœ— Search bar component failed: ' + error.message + '</span>';
      }
    }

    // Test 4: Navigation
    function testNavigation() {
      const links = document.querySelectorAll('a[href]');
      let validLinks = 0;
      links.forEach(link => {
        if (link.href && link.href.includes('OJTProject')) {
          validLinks++;
        }
      });
      
      if (validLinks > 0) {
        document.getElementById('navigationTest').innerHTML = 
          '<span class="test-success">âœ“ Navigation links working (' + validLinks + ' valid links)</span>';
        testResults.navigation = true;
      } else {
        document.getElementById('navigationTest').innerHTML = 
          '<span class="test-warning">âš  Navigation links may have issues</span>';
      }
    }

    // Update summary
    function updateSummary() {
      const passed = Object.values(testResults).filter(Boolean).length;
      const total = Object.keys(testResults).length;
      
      let summaryHTML = `<strong>Test Results: ${passed}/${total} tests passed</strong><br>`;
      
      if (passed === total) {
        summaryHTML += '<span class="test-success">ðŸŽ‰ All tests passed! Search functionality is working correctly.</span>';
      } else {
        summaryHTML += '<span class="test-warning">âš  Some tests failed. Please check the individual test results above.</span>';
      }
      
      document.getElementById('summary').innerHTML = summaryHTML;
    }

    // Run all tests
    async function runTests() {
      await testDatabase();
      await testSearchAPI();
      testSearchComponent();
      testNavigation();
      
      // Update summary after a short delay
      setTimeout(updateSummary, 1000);
    }

    // Run tests when page loads
    document.addEventListener('DOMContentLoaded', runTests);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html> 